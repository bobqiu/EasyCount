[system]
sql=\
with \
(select concat(g, cast (AGGRTIME DIV 1000 as string)) k, hllp(x) b from t group by g coordinate by time with aggr interval 60 seconds) tmp, \
(select tmp.k k, hllp_merge(tmp.b, tdedim.b) ball from tmp left join tdedim on tmp.k=tdedim.k) tmp2 \
insert into tdedim select k, ball from tmp2, \
insert into dest select k, hllp_get(ball) from tmp2

[tabledesc-1]
table.name=t
table.fields=g,string,:x,string,:time,bigint,
table.field.splitter=,
table.list.splitter=;
table.map.splitter=:

[tabledesc-dimtable]
table.type=mem
table.name=tdedim
table.fields=k,string,:b,binary,
table.field.key=k

table.field.splitter=,
table.list.splitter=;
table.map.splitter=:

[tabledesc-2]
table.name=dest
table.binary.mode=false
table.fields=k,string,:cd,bigint,
table.field.splitter=,
table.list.splitter=;
table.map.splitter=:


