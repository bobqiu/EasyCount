[system]
sql=with \
(select str_to_map(strMsg, "&", "=") mapdata from kernelmsglog) tmp, \
(select cast(map_get(mapdata, "gid") as int) gid, cast (map_get(mapdata, "pay_amt") as bigint) pay_amt, \
cast (map_get(mapdata, "req_time") as bigint) req_time from tmp) tmp1 \
insert into rtc_idata_ieg_pay_statics select from_unixtime(AGGRTIME, "yyyyMMddHHmm"), gid, sum(pay_amt) from tmp1 \
where gid>1100 group by gid coordinate by req_time*1000 with aggr interval 60 seconds, \
insert into __printtable select "shouyoushouru", count(gid), count(if(gid>1100, gid, null)) from tmp1, \
insert into __printtable select "mapdata", mapdata from tmp , \
insert into __printtable select "mapdata1", gid, pay_amt, req_time from tmp1 , \
insert into kernelmsglog select concat("|gid=9990&pay_amt=1000&req_time=", cast (unix_timestamp()*1000 as string),"|sss") from __innertable(100)


[tabledesc-1-kernelmsglog]
table.name=kernelmsglog
table.fields=strMsg,STRING,:szServerIP,STRING,:used_time,BIGINT,:logtime,STRING,:result,BIGINT
table.topic=hy_tgclub
table.interfaceId=kernelmsglog
table.type=tube
table.tube.master=10.215.132.176
table.tube.port=8609
table.field.splitter=|
splitter=|
table.localmode.addr=127.0.0.1
table.localmode.port=6000

[tabledesc-res-goldcoinout]
table.name=rtc_idata_ieg_pay_statics
table.fields=vDatetime_m,string,:gid,int,:payAmt,bigint,
table.type=tpg
table.tpg.db.host=ieg-bi-tdw.tencent-distribute.com
table.tpg.db.port=5432
table.tpg.db.name=ieg_idata
table.tpg.db.username=u_ieg_idata
table.tpg.db.passwd=u_ieg_idata@2014
table.localmode.addr=127.0.0.1
table.localmode.port=6001


