[system]
sql=with \
(select str_to_map(strMsg, "&", "=") mapData from kernelmsglog) tmp, \
(select cast(map_get(mapData, "gid") as int) gid, cast (map_get(mapData, "pay_amt") as bigint) pay_amt, \
cast (map_get(mapData, "req_time") as bigint) req_time from tmp) tmp1 \
insert into ieg_pay_statics select from_unixtime(AGGRTIME, "yyyyMMddHHmm"), gid, sum(pay_amt) from tmp1 \
group by gid coordinate by req_time*1000 with aggr interval 60 seconds 


[tabledesc-1-kernelmsglog]
table.name=kernelmsglog
table.fields=strMsg,STRING,:szServerIP,STRING,:used_time,BIGINT,:logtime,STRING,:result,BIGINT
table.topic=hy_tgclub
table.interfaceId=kernelmsglog
table.type=tube
table.tube.master=10.215.132.176
table.tube.port=8609
table.field.splitter=|
splitter=|

[tabledesc-res-goldcoinout]
table.name=ieg_pay_statics
table.fields=dtStatis,string,:gid,int,:payAmt,bigint,
table.type=tpg
table.tpg.db.host=ieg-bi-tdw.tencent-distribute.com
table.tpg.db.port=5432
table.tpg.db.name=ieg_idata
table.tpg.db.username=u_ieg_idata
table.tpg.db.passwd=u_ieg_idata@2014

