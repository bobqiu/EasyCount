[system]
sql=with \
(select g k, hllp(x) b, AGGRTIME agtime from t group by g coordinate by time with aggr interval 20 seconds) tmp, \
(select tmp.k k, hllp_merge(tmp.b, redisdim.b) ball, agtime from tmp left join redisdim on tmp.k=redisdim.k) tmp2 \
insert into redisdim with k as KEY select k, ball from tmp2, \
insert into dest select k, hllp_get(b), agtime from tmp, \
insert into dest select k, hllp_get(ball), agtime from tmp2

sql1=insert into dest select concat(g, "-", cast (AGGRTIME DIV 1000 as string)) k, hllp(x) b from t group by g \
insert into dest select k, hllp_get(ball), agtime from tmp2

[tabledesc-1]
table.name=t
table.fields=g,string,:x,string,:time,bigint,
table.field.splitter=,
table.list.splitter=;
table.map.splitter=:

table.zk.servers=tl-zk-test1:2181,tl-zk-test2:2181,tl-zk-test3:2181,tl-zk-test4:2181,tl-zk-test5:2181
table.zk.root=/meta
table.topic=boss
table.interfaceId=1

[tabledesc-dimtable]
table.type=redis
table.name=redisdim
table.fields=k,string,:b,binary,
table.field.key=k
table.binary.mode=true

table.field.splitter=,
table.list.splitter=;
table.map.splitter=:

table.redis.host=127.0.0.1
table.redis.port=6379

[tabledesc-2]
table.name=dest
table.binary.mode=false
table.fields=k,string,:cd,bigint,
table.field.splitter=,
table.list.splitter=;
table.map.splitter=:

table.zk.servers=tl-zk-test1:2181,tl-zk-test2:2181,tl-zk-test3:2181,tl-zk-test4:2181,tl-zk-test5:2181
table.zk.root=/meta
table.topic=snglogserver
table.interfaceId=1
table.field.splitter=|



