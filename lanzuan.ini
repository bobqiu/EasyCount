[system]
sql=INSERT INTO bd_dl_customid_res SELECT from_unixtime(AGGRTIME DIV 1000, 'yyyy-MM-dd HH:mm:ss'),custom_id,count(1),sum(complete),avg(total_filesize / total_duration),collect_set(CASE complete WHEN "1" THEN uin ELSE null END),collect_set(CASE complete WHEN "0" THEN uin ELSE null END) FROM ieg_bd_download GROUP BY custom_id COORDINATE BY unix_timestamp(time_t, 'yyyyMMddHHmmss')*1000 WITH AGGR INTERVAL 60 SECONDS, INSERT INTO bd_dl_customid_detail_res SELECT from_unixtime(AGGRTIME DIV 1000, 'yyyy-MM-dd HH:mm:ss'),province,isp,custom_id,count(1),sum(complete),avg(total_filesize / total_duration),collect_set(CASE complete WHEN "1" THEN uin ELSE null END),collect_set(CASE complete WHEN "0" THEN uin ELSE null END) FROM ieg_bd_download GROUP BY custom_id,province,isp COORDINATE BY unix_timestamp(time_t, 'yyyyMMddHHmmss')*1000 WITH AGGR INTERVAL 60 SECONDS

[tabledesc-1]
table.name=ieg_bd_download
table.fields=time_t,string,:custom_id,string,:total_filesize,bigint,:uin,string,:speed_type,string,:total_duration,bigint,:province,string,:complete,string,:isp,string,
table.zk.servers=tl-zk-td1:2181,tl-zk-td2:2181,tl-zk-td3:2181,tl-zk-td4:2181,tl-zk-td5:2181
table.zk.root=/meta
table.topic=ieg_bd
table.interfaceId=bd_download
table.field.splitter=;

[tabledesc-2]
table.name=bd_dl_customid_res
table.fields=stime,string,:custom_id,string,:count,bigint,;complete,bigint,:average,double,:success_list,string,:fail_listm,string,
table.type=tpg
table.tpg.db.host=ieg-bi-tdw.tencent-distribute.com
table.tpg.db.port=5432
table.tpg.db.name=ieg_mapleleaf
table.tpg.db.username=u_ieg_mapleleaf
table.tpg.db.passwd=Leaf,Qwert%,01

table.field.splitter=;

[tabledesc-3]
table.name=bd_dl_customid_detail_res
table.fields=stime,string,:custom_id,string,:province,string,:isp,string,:count,bigint,;complete,bigint,:average,double,:success_list,string,:fail_listm,string,
table.type=tpg
table.tpg.db.host=ieg-bi-tdw.tencent-distribute.com
table.tpg.db.port=5432
table.tpg.db.name=ieg_mapleleaf
table.tpg.db.username=u_ieg_mapleleaf
table.tpg.db.passwd=Leaf,Qwert%,01

table.field.splitter=;



